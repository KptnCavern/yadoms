#include "stdafx.h"
#include "SQLiteQueryFunctions.h"

namespace database { 
namespace sqlite {

   CSQLiteQueryFunctions::CSQLiteQueryFunctions()
   { 
   }

   CSQLiteQueryFunctions::~CSQLiteQueryFunctions()
   {
   }

   const std::string CSQLiteQueryFunctions::coalesce(const std::string & fieldOrQuery, const std::string & valueIfNull)
   {
      return (boost::format("ifnull(%1%, %2%)") % fieldOrQuery % valueIfNull).str();
   }

   const std::string CSQLiteQueryFunctions::dateToIsoString(const std::string &columnName)
   {
      return "(strftime('%s', isodate(" + columnName + ")) * 1000)";
   }

   const std::string CSQLiteQueryFunctions::castNumeric(const std::string & fieldOrQuery)
   {
      return cast(fieldOrQuery, "real");
   }



} //namespace sqlite
} //namespace database 

