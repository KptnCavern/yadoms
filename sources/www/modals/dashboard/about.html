<div id="dashboard-about">
   <h1 class="page-header" data-i18n="modals.dashboard.sub-windows.about.title"></h1>
   
   <h2 class="sub-header" data-i18n="modals.dashboard.sub-windows.about.links"></h2>
   
   <div>
	   <a href="http://www.yadoms.com" data-i18n="modals.dashboard.sub-windows.about.YadomsWebsite" target="_blank"></a><br>
	   <a href="https://github.com/Yadoms/yadoms/issues" data-i18n="modals.dashboard.sub-windows.about.ReportABug" target="_blank"></a><br>
	   <a href="https://github.com/Yadoms/yadoms" data-i18n="modals.dashboard.sub-windows.about.github" target="_blank"></a><br>
	   <a href="http://yadoms.com/forum/" data-i18n="modals.dashboard.sub-windows.about.forum" target="_blank"></a><br>
   </div>
   
   <h2 class="sub-header" data-i18n="modals.dashboard.sub-windows.about.licensesUse"></h2>

   <div class="table-responsive summary-table" align="center">
	   <table class="table table-bordered table-striped dashboard-list">
		  <tr>
			 <td class="vert-align"><a href="https://www.boost.org/" target="_blank">Boost</a></td>
			 <td class="vert-align"><a href="http://knockoutjs.com/" target="_blank">knockout</a></td>
		  </tr>
		  <tr>
			 <td class="vert-align"><a href="http://getbootstrap.com" target="_blank">Bootstrap</a></td>
			 <td class="vert-align"><a href="https://github.com/rgrove/lazyload/" target="_blank">lazyload</a></td>
		  </tr>
		  <tr>
			 <td class="vert-align"><a href="https://victor-valencia.github.com/bootstrap-iconpicker" target="_blank">Bootstrap IconPicker</a></td>
			 <td class="vert-align"><a href="http://momentjs.com" target="_blank">moment</a></td>
		  </tr>
		  <tr>
			 <td class="vert-align"><a href="https://github.com/google/blockly" target="_blank">Blockly</a></td>
			 <td class="vert-align"><a href="http://needim.github.com/noty/" target="_blank">noty</a></td>
		  </tr>
		  <tr>
			 <td class="vert-align"><a href="http://fontawesome.io" target="_blank">Font awesome</a></td>
			 <td class="vert-align"><a href="http://packery.metafizzy.co" target="_blank">packery</a></td>
		  </tr>
		  <tr>
			 <td class="vert-align"><a href="http://www.highcharts.com/" target="_blank">Highcharts</a></td>
			 <td class="vert-align"><a href="https://www.pocoproject.org/" target="_blank">Poco</a></td>
		  </tr>
		 <tr>
			 <td class="vert-align"><a href="http://i18next.com" target="_blank">i18next</a></td>
			 <td class="vert-align"><a href="http://www.d-project.com/" target="_blank">QR Code for Javascript</a></td>
		  </tr>
		 <tr>
			 <td class="vert-align"><a href="https://github.com/korengal/jqBootstrapValidation/network" target="_blank">jqBootstrapValidation</a></td>
			 <td class="vert-align"><a href="https://github.com/google/protobuf" target="_blank">Protobuf</a></td>
		  </tr>	 	
		 <tr>
			 <td class="vert-align"><a href="http://jquery.com/" target="_blank">jQuery</a></td>
			 <td class="vert-align"><a href="https://www.python.org/" target="_blank">Python</a></td>
		  </tr>	 
		  <tr>
			 <td class="vert-align"><a href="https://github.com/blueimp/jQuery-MD5" target="_blank">jQuery MD5</a></td>
			 <td class="vert-align"><a href="http://qunitjs.com/" target="_blank">Qunit</a></td>
		  </tr>	 
		  <tr>
			 <td class="vert-align"><a href="http://jqueryui.com" target="_blank">jQuery ui</a></td>
			 <td class="vert-align"><a href="http://www.swig.org/" target="_blank">SWIG</a></td>
		  </tr>	 	 
		  <tr>
			 <td class="vert-align"><a href="http://touchpunch.furf.com/" target="_blank">jQuery touch punch</a></td>
			 <td class="vert-align"><a href="http://weathericons.io" target="_blank">Weather Icons</a></td>
		  </tr>	 	
		  <tr>
			 <td class="vert-align"><a href="https://parall.ax/products/jspdf" target="_blank">jsPDF</a></td>
			 <td class="vert-align"></td>
		  </tr>	 	  
	   </table>    
   </div>
   
   <h2 class="sub-header" data-i18n="modals.dashboard.sub-windows.about.plugins"></h2>

   <div class="table-responsive summary-table" align="center">
	   <table id="plugin-package-list" class="table table-bordered table-striped dashboard-list">
		  <tr>
			 <td data-i18n="modals.dashboard.sub-windows.about.table.displayName"></td>
			 <td data-i18n="modals.dashboard.sub-windows.about.table.authors"></td>
			 <td data-i18n="modals.dashboard.sub-windows.about.table.credits"></td>
		  </tr>
		  <!-- plugin instance will be listed here-->
	   </table>	   
   </div>   
   
   <h2 class="sub-header" data-i18n="modals.dashboard.sub-windows.about.widgets"></h2>
   
   <div class="table-responsive summary-table" align="center">
	   <table id="widget-package-list" class="table table-bordered table-striped dashboard-list">
		  <tr>
			 <td data-i18n="modals.dashboard.sub-windows.about.table.displayName"></td>
			 <td data-i18n="modals.dashboard.sub-windows.about.table.authors"></td>
			 <td data-i18n="modals.dashboard.sub-windows.about.table.credits"></td>
		  </tr>
		  <!-- plugin instance will be listed here-->
	   </table>	   
   </div>
   
</div>

<script src="libs/markdown-it/markdown-it.min.js"></script>

<script>

   Yadoms.initializeAboutDashboard = function () {
   
     var d = new $.Deferred();
		
	 var md = window.markdownit({
		  html: true,
		  breaks:true,
		 highlight: function (str, lang) {
		   if (lang && hljs.getLanguage(lang)) {
			 try {
			   return hljs.highlight(lang, str).value;
			 } catch (__) {}
		   }

		   return ''; // use external default escaping
		 }
	   });	
	    
	   function getWidgetDomRow(widgetPackage) {
		  return $("table#widget-package-list").find("tr[widget-id='" + widgetPackage + "']");
	   }

	   function getPluginDomRow(pluginPackage) {
		  return $("table#plugin-package-list").find("tr[plugin-id='" + pluginPackage + "']");
	   }	   
	   
	    AddWidgetPackage = function( name, authors, credits, url ) {
		
		  //we add it to the DOM
		  var $widgetPackageList = $("table#widget-package-list");

		  var frameworkWidgetPackage = "<tr widget-id=\"" + name + "\">" +
				  "<td class=\"widget-displayName vert-align\"></td>" +
				  "<td class=\"widget-authors vert-align\"></td>" +
				  "<td class=\"widget-credits vert-align\" align=\"left\"></td>" +
				  "</tr>";		
		
		  $widgetPackageList.append( frameworkWidgetPackage );

          var $widgetPackageRow = getWidgetDomRow( name );		  
		  
		  //we fill the data
		  $widgetPackageRow.find("td.widget-displayName").html( "<a href=\"" + url + "\" target=\"_blank\">" + name + "</a>" );
		  $widgetPackageRow.find("td.widget-authors").html( authors );
		  $widgetPackageRow.find("td.widget-credits").html( credits );
		
		};
		
	    AddPluginPackage = function( type, name, authors, credits, url ) {
		
		  //we add it to the DOM
		  var $pluginPackageList = $("table#plugin-package-list");

		  var frameworkPluginPackage = "<tr plugin-id=\"" + type + "\">" +
				  "<td class=\"plugin-displayName vert-align\"></td>" +
				  "<td class=\"plugin-authors vert-align\"></td>" +
				  "<td class=\"plugin-credits vert-align\" align=\"left\"></td>" +
				  "</tr>";		
		
		  $pluginPackageList.append( frameworkPluginPackage );

          var $pluginPackageRow = getPluginDomRow( type );		  
		  
		  //we fill the data
		  $pluginPackageRow.find("td.plugin-displayName").html( "<a href=\"" + url + "\" target=\"_blank\">" + name + "</a>" );
		  $pluginPackageRow.find("td.plugin-authors").html( authors );
		  $pluginPackageRow.find("td.plugin-credits").html( credits );
		
		};		
		
		YadomsInformationManager.getList()
           .done(function (data) { 
			// delete all existing information
			$("table#plugin-package-list").find("tr:gt(0)").remove();
			
			 // Enter all Plugins into an array
			 var tabPlugins = [];
		  
			 Object.keys(PluginManager.pluginTypes).forEach(function(key) {
				if( (!data.developerMode && !key.startsWith("dev-")) || data.developerMode) {
				   var value = PluginManager.pluginTypes[key];
				   
				   tabPlugins.push ( {plugin: value, friendlyName: $.t("plugins/" + value.type + ":name" ) });
				}
			 });
			 
			 // sort each Plugins Name in the language selected
			 tabPlugins = sortListItemsWithFriendlyName ( tabPlugins );
			 
			 //foreach element of the array
			 $.each(tabPlugins, function(index, value) {
				
				var result = "";
				if ( !isNullOrUndefined ( value.plugin.package.credits ))
					result = md.renderInline( value.plugin.package.credits ); 
				
				AddPluginPackage ( value.plugin.type, value.friendlyName, value.plugin.package.author, result, value.plugin.package.url );
			 });		 
			
			// delete all existing information
			$("table#widget-package-list").find("tr:gt(0)").remove();
		  
		    var WidgetList = [];
		  
			// scan all widgets packages
			for (var index in WidgetPackageManager.widgetPackages) {
				if (WidgetPackageManager.widgetPackages.hasOwnProperty(index)) {
					var value = WidgetPackageManager.widgetPackages[index].package;
					
					if ((!value.type.startsWith("system-")) && ((data.developerMode) || (!value.type.startsWith("dev-")))) {
                       var i18NContext = value.type + ":";
					   WidgetList.push ( {displayName: $.t("widgets/" + i18NContext + "name"), widget: value} );
					}
				}
			}
			
			//sort all widgets
			WidgetList = sortListItemsWithdisplayName ( WidgetList );
			
			//display all widgets
			$.each(WidgetList, function(index, value) {
				
				var result = "";
				if ( !isNullOrUndefined ( value.widget.credits ))
				   result = md.renderInline( value.widget.credits ); 
				
                AddWidgetPackage ( value.displayName, value.widget.author, result, value.widget.url );
			});
			
		d.resolve();
		});
		
		return d.promise();
   }

</script>