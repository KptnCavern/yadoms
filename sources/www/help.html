<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Yet Another DOMotic System help page">
    <meta name="author" content="yadoms team">
    <link rel="shortcut icon" href="assets/ico/favicon.png">

    <title>Yadoms help page</title>

    <!-- Bootstrap core CSS -->
    <link href="libs/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-non-responsive.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="css/yadoms.css" rel="stylesheet">
	 <link href="libs/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="css/help.css" rel="stylesheet">
    <link href="libs/highlight/default.css" rel="stylesheet" >
  </head>

  <body>
  <!-- Fixed navbar -->
  <div class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
          <div class="row" id="mainNavBar">
              <div class="col-md-12">
                  <div class="navbar-header">
                     <img src="img/icon_256.png" class="img-responsive pull-left application-logo"/>
                     <a class="navbar-brand" href="#">Yadoms Help</a>
                  </div>
              </div>
           </div>
      </div><!--/.nav-collapse -->
  </div>

  <div id="tabContainer">
      <div class="center">
         <div id="content">
         </div>
      </div>
      <footer class="footer">
         <button class="btn btn-primary" id="btn-show-qrcode"><i class="fa fa-qrcode"></i></button>
         <label id="copyrightLabel" class="label label-default">&copy; Yadoms 2016</label>
      </footer>
  </div>

   <!-- Bootstrap core JavaScript
   ================================================== -->
   <!-- Placed at the end of the document so the pages load faster -->
   <script src="libs/jquery/js/jquery-2.2.0.min.js"></script>
   <script src="libs/bootstrap/js/bootstrap.js"></script>

   <script src="libs/knockout/js/knockout-3.4.0.js"></script>

   <script src="libs/i18next/js/i18next-1.7.2.js"></script>
   <script src="libs/lazyload/js/lazyload.js"></script>

   <script src="libs/moment.js/js/moment-with-langs.min.js"></script>
   <script src="libs/moment.js/js/moment-timezone.min.js"></script>
   <script src="libs/moment.js/js/moment-timezone-data.min.js"></script>

   <script src="js/knock-out-extenders.js"></script>
   <script src="js/iso-language-codes.js"></script>
   <script src="js/utility.js"></script>
   <script src="js/objects/yadoms-information-manager.js"></script>
   <script src="js/objects/page-manager.js"></script>
   <script src="js/objects/lazy-loader-manager.js"></script>
   <script src="js/objects/encryption-manager.js"></script>

   <script src="libs/jqBootstrapValidation/js/jqBootstrapValidation.js"></script>

   <script src="js/objects/configuration/configuration-helper.js"></script>
   <script src="js/objects/configuration/configuration-control-manager.js"></script>
   <script src="js/objects/configuration/int-parameter-handler.js"></script>
   <script src="js/objects/configuration/decimal-parameter-handler.js"></script>
   <script src="js/objects/configuration/enum-parameter-handler.js"></script>
   <script src="js/objects/configuration/string-parameter-handler.js"></script>
   <script src="js/objects/configuration/bool-parameter-handler.js"></script>
   <script src="js/objects/configuration/section-parameter-handler.js"></script>
   <script src="js/objects/configuration/keyword-parameter-handler.js"></script>
   <script src="js/objects/configuration/radio-section-parameter-handler.js"></script>
   <script src="js/objects/configuration/color-parameter-handler.js"></script>
   <script src="js/objects/configuration/icon-parameter-handler.js"></script>
   <script src="js/objects/configuration/list-parameter-handler.js"></script>

   <script src="js/rest-engine.js"></script>

   <script src="js/objects/date-time.js"></script>
   
   <script src="libs/bootstrap-iconpicker-1.7.0/js/bootstrap-iconpicker.min.js"></script>

   <script src="libs/jquery-MD5/js/jquery.md5.js"></script>

   <script src="libs/jquery-ui/js/jquery-ui.js"></script>
   
   <script src="libs/highlight/highlight.pack.js"></script>
   <script src="libs/markdown-it/markdown-it.min.js"></script>
   
   <div id="templates" class="hidden"></div>

	<script type="text/javascript">

   //base configuration
   $.ajaxSetup({ contentType: "application/json; charset=utf-8"});

   $("#copyrightLabel").html("&copy; Yadoms " + new Date().getFullYear());

   /**
   * On page loaded
   */
   $(document).ready(function() {

      //we start i18n engine
      var option = { resGetPath: "locales/__lng__.json", fallbackLng:"en", useDataAttrOptions: true};
      i18n.init(option, function() {
         loadContent(readUrlParam("helpUrl"))
         .done(function(content) {
            container = $("div#tabContainer").find("div#content");
             var md = window.markdownit({
                 highlight: function (str, lang) {
                   if (lang && hljs.getLanguage(lang)) {
                     try {
                       return hljs.highlight(lang, str).value;
                     } catch (__) {}
                   }

                   return ''; // use external default escaping
                 }
               });
             

             
             container.html(md.render(content));
         })
         .fail(function(err) {
            container = $("div#tabContainer").find("div#content");
            console.error(err);
            container.html(err);
         });
         
         
      });

      /**
      * Callback of the click on the show qr code button
      * Make lazy loading of the qrcode modal
      */
      $("#btn-show-qrcode").click(function() {
         Yadoms.modals.qrCode.loadAsync()
         .done(function() {
            $('#qrcode-modal').modal();
         });
      });
   });
   
      
   /**
   * Read a parameter from the URL
   */
   function readUrlParam(key) {
      params = location.search.substring(1).split("&");
      for (var i=0; i<params.length; i++)
      {
         data = params[i].split("=");
         if ( [data[0]] == key ) {
            return decodeURIComponent(data[1]);
         }
      }
   }
   
   /**
   * Load the help content
   * @param helpUrl Help URL to load
   * @param callback
   */
   function loadContent(helpUrl) {
      assert(!isNullOrUndefined(helpUrl), "helpUrl must be defined");
      
      return $.ajax({
         dataType: "text",
         url: helpUrl,
         async: false
      });
   };

	</script>
  </body>
</html>

